<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wanderfalken</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Ubuntu", "Cantarell", sans-serif;
      color: #ffffff;
      background-color: #000000;
      text-align: center;
      padding: 20px;
      margin: 0;
      user-select: none;
    }
    .iframe-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin-top: 0px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    iframe {
      border: 3px solid #000000;
      width: 650px;
      height: 365.625px;
      border-radius: 10px;
      transition: border 0.3s;
      cursor: default;
    }
    iframe:hover {
      border: 3px solid #333333;
    }
	.containers {
	  gap: 1px;
	  display: grid;
	  grid-auto-flow: column;
	  grid-auto-columns: min-content;
	  width: 100%;
	  place-items: center;
	  justify-content: center;
	}
    .button-container {
      position: relative;
      margin-top: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0px;
      flex-direction: column;
      background-color: #111111;
      padding: 5px;
      border-radius: 15px;
      width: 190px;
	  height: 135px;
      box-shadow: inset 0px 4px 4px rgba(2, 2, 2, 0.5);
      z-index: 0;
    }
	.text-container {
	  width: 190px;
	  height: 135px;
	  background: #111111;
	  border-radius: 15px;
	  padding: 5px;
	  margin-top: 10px;
	  position: relative;
	}
    .button {
      font-size: 16px;
      color: #ffffff;
      background-color: #00000000;
      border: 0;
      border-radius: 10px;
      cursor: default;
      width: 190px;
      height: 45px;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Ubuntu", "Cantarell", sans-serif;
      text-align: center;
      transition: background-color 0.3s, color 0.3s;
      z-index: 2;
      pointer-events: auto;
    }
    .button.active {
      color: #ffffff;
      pointer-events: none;
    }
    .button:hover {
      background: #222222;
    }
    .countdown {
      font-size: 16px;
      margin-top: 20px;
      color: #666666;
    }
    .monospace {
      font-family: "Roboto Mono", monospace;
    }
    .glide-button {
      position: absolute;
      width: 190px;
      height: 45px;
      border: none;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
      z-index: 3;
      pointer-events: none !important;
      user-select: none;
    }
    .glide-button.animate {
      transition: top 0.3s ease, left 0.3s ease;
    }
  </style>
</head>
<body>
  <h1>Wanderfalken</h1>
  <div id="iframe-container" class="iframe-container" style="opacity: 1;">
    <iframe src="./Wanderfalken_files/iframe.html" allowfullscreen></iframe>
    <iframe src="./Wanderfalken_files/iframe(1).html" allowfullscreen></iframe>
  </div>
<div class="containers">
  <div class="button-container" id="button-container">
    <div class="glide-button animate" id="glide-button" style="top: 5px; left: 5px;"></div>
    <button class="button" id="innen-aussen-btn" onclick="showIframe('innen_und_aussen', 'innen-aussen-btn')">Innen- und Außenraum</button>
    <button class="button" id="innen-btn" onclick="showIframe('innen', 'innen-btn')">Innenraum</button>
    <button class="button" id="aussen-btn" onclick="showIframe('aussen', 'aussen-btn')">Außenraum</button>
  </div>
  <div class="text-container">
  <a class="countdown" id="countdown-timer">
    Lade neu in: <span class="monospace">--</span>:<span class="monospace">--</span><br>
    Dies muss gemacht werden, um die Webcams zu aktualisieren, falls der Stream nicht richtig übertragen wird.
  </a>
  </div>
</div>

  <script>
    const iframes = {
      aussen: `<iframe src="https://v.angelcam.com/iframe?v=xblmn15jr2&autoplay=1&mute=1" allowfullscreen></iframe>`,
      innen: `<iframe src="https://v.angelcam.com/iframe?v=oxrnpd7gl8&autoplay=1&mute=1" allowfullscreen></iframe>`,
      innen_und_aussen: `
        <iframe src="https://v.angelcam.com/iframe?v=oxrnpd7gl8&autoplay=1&mute=1" allowfullscreen></iframe>
        <iframe src="https://v.angelcam.com/iframe?v=xblmn15jr2&autoplay=1&mute=1" allowfullscreen></iframe>
      `
    };

    const titles = {
      aussen: "Außenraum - Wanderfalken",
      innen: "Innenraum - Wanderfalken",
      innen_und_aussen: "Innen- und Außenraum - Wanderfalken"
    };

    function moveGlideButton(activeButtonId, animate = false) {
      const glideButton = document.getElementById('glide-button');
      const activeButton = document.getElementById(activeButtonId);
      if (activeButton) {
        const buttonContainer = document.getElementById('button-container');
        const buttonRect = activeButton.getBoundingClientRect();
        const containerRect = buttonContainer.getBoundingClientRect();
        glideButton.classList.toggle('animate', animate);
        glideButton.style.top = `${buttonRect.top - containerRect.top}px`;
        glideButton.style.left = `${buttonRect.left - containerRect.left}px`;
      }
    }

    function showIframe(type, activeButtonId) {
      const activeButton = document.getElementById(activeButtonId);
      if (activeButton.classList.contains('active')) return;

      const container = document.getElementById('iframe-container');
      container.style.opacity = 0;

      setTimeout(() => {
        container.innerHTML = iframes[type];
        document.title = titles[type];
        moveGlideButton(activeButtonId, true);
        setTimeout(() => container.style.opacity = 1, 1000);
      }, 300);

      localStorage.setItem('activeIframe', type);
      localStorage.setItem('activeButtonId', activeButtonId);

      // Button-Zustände aktualisieren
      document.querySelectorAll('.button').forEach(button => {
        button.classList.remove('active');
        button.style.pointerEvents = 'auto';
      });
      activeButton.classList.add('active');
      activeButton.style.pointerEvents = 'none';
    }

    function handleLayoutChange() {
      const savedButtonId = localStorage.getItem('activeButtonId') || 'innen-aussen-btn';
      moveGlideButton(savedButtonId, false);
    }

    window.onload = function () {
      const savedIframe = localStorage.getItem('activeIframe') || 'innen_und_aussen';
      const savedButtonId = localStorage.getItem('activeButtonId') || 'innen-aussen-btn';
      showIframe(savedIframe, savedButtonId);
      moveGlideButton(savedButtonId, false);
      startCountdown(600);
      window.addEventListener('resize', handleLayoutChange);
	}

        function startCountdown(duration) {
            const timerElement = document.getElementById('countdown-timer');
            let remainingTime = duration;
            const interval = setInterval(() => {
                const minutes = Math.floor(remainingTime / 60);
                const seconds = remainingTime % 60;
                timerElement.innerHTML = `Lade neu in: <span class="monospace">${String(minutes).padStart(2, "0")}</span>:<span class="monospace">${String(seconds).padStart(2, "0")}</span><br>Dies muss gemacht werden, um die Webcams zu aktualisieren, falls der Stream nicht richtig übertragen wird.`;
                if (remainingTime > 0) {
                    remainingTime -= 1;
                } else {
                    clearInterval(interval);
                    location.reload();
                }
            }, 1000);
        }
    </script>
</body>
</html>